<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esc√°ner de Jugos - Informaci√≥n Nutricional</title>
    <style>
        *:root {
            --verde: #461659;
            --rosa: #5b7f14;
            --rosa-oscuro: #b51847;
            --beige: #ffedc3;
            --marron: #8D6748;
            --negro: #000;
            --blanco: #dabdff;
    }

    header {
  background: var(--verde);
  color: var(--blanco);
  padding:  20px;
  margin-bottom: 20px; /* Espacio despu√©s del header */
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

    header div:first-child {
      font-size: 28px;
      font-weight: bold;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
        
        {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background:  var(--beige);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, var(--verde), var(--rosa));
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .search-section {
            padding: 30px;
            text-align: center;
            background: #f8f9fa;
        }

        .input-group {
            margin: 20px 0;
        }

        .input-group input {
            width: 100%;
            max-width: 400px;
            padding: 15px 20px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 25px;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            border-color:  var(--rosa);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-decoration: none;
            display: inline-block;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-volver {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .btn-escanear {
            background: linear-gradient(45deg, #007bff, #6f42c1);
        }

        .resultado-container {
            padding: 30px;
            display: none;
        }

        .producto-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
        }

        .producto-titulo {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .producto-marca {
            font-size: 1.2em;
            color: #666;
        }

        .nutricional-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .nutricional-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border-left: 4px solid  var(--rosa);
            transition: all 0.3s ease;
        }

        .nutricional-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .nutricional-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .valor-grande {
            font-size: 1.8em;
            font-weight: bold;
            color: #252088;
        }

        .cucharadas {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            border: 2px solid #ffc107;
        }

        .cucharadas h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .recomendacion {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
        }

        .recomendacion.buena {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #28a745;
        }

        .recomendacion.moderada {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            border: 2px solid #ffc107;
        }

        .recomendacion.alta {
            background: linear-gradient(135deg, #f8d7da, #f1b0b7);
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .dato-oms {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }

        .ingredientes {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .ingredientes h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .botones {
            text-align: center;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #dc3545;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .nutricional-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<header>
    <div>Scan & Sip</div>

  </header>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•§ Esc√°ner de Jugos</h1>
            <p>Conoce la informaci√≥n nutricional de tu jugo favorito</p>
        </div>

        <!-- Secci√≥n de b√∫squeda -->
        <div class="search-section" id="searchSection">
            <h2>Ingresa el c√≥digo del producto</h2>
            <div class="input-group">
                <input type="text" id="codigo" placeholder="Ej: 001, ABC123, etc." onkeypress="if(event.key==='Enter') buscarJugo()">
            </div>
            <button onclick="buscarJugo()" class="btn">ESCANE√Å AQU√ç</button>
        </div>

        <!-- Secci√≥n de resultados -->
        <div class="resultado-container" id="resultadoContainer">
            <div class="producto-header">
                <div class="producto-titulo" id="nombre">Cargando...</div>
                <div class="producto-marca" id="marca"></div>
            </div>

            <div class="nutricional-grid">
                <div class="nutricional-card">
                    <h3>üç¨ Az√∫car</h3>
                    <div class="valor-grande" id="azucar">-</div>
                </div>
                <div class="nutricional-card">
                    <h3>üî• Calor√≠as</h3>
                    <div class="valor-grande" id="calorias">-</div>
                </div>
                <div class="nutricional-card">
                    <h3>üìè Volumen</h3>
                    <div class="valor-grande" id="volumen">-</div>
                </div>
                <div class="nutricional-card">
                    <h3>ü•§ Tipo</h3>
                    <div class="valor-grande" id="tipo" style="font-size: 1.2em;">-</div>
                </div>
            </div>

            <div class="cucharadas">
                <h3>ü•Ñ Equivalencia en Az√∫car</h3>
                <div class="valor-grande" id="cucharadas">- cucharadas</div>
            </div>

            <div class="recomendacion" id="recomendacion">
                Evaluando producto...
            </div>

            <div class="dato-oms">
                <strong>üí° Dato importante:</strong> La OMS recomienda que no deber√≠an superar los 15g aprox (3 cucharaditas de az√∫car) 
            </div>

            <div class="ingredientes">
                <h3>üîç Ingredientes:</h3>
                <p id="ingredientes">-</p>
            </div>

            <div class="botones">
                <button onclick="escanearOtro()" class="btn btn-escanear">üîç Escanear otro producto</button>
                <a href="cuerpo_juguitos.html" class="btn btn-volver"> Volver al inicio</a>
            </div>
        </div>
    </div>

    <script>
     // Funci√≥n para calcular cucharadas de az√∫car
function calcularCucharadas(azucarTexto) {
    const match = azucarTexto.match(/(\d+(?:\.\d+)?)/);
    if (!match) return "N/A";
    
    const gramos = parseFloat(match[1]);
    if (isNaN(gramos)) return "N/A";
    
    // 1 cucharadita = 5g de az√∫car (15g = 3 cucharaditas)
    const cucharaditas = (gramos / 5).toFixed(1);
    return cucharaditas;
}

// Funci√≥n para dar recomendaci√≥n nutricional general
function darRecomendacion(azucarTexto) {
    const match = azucarTexto.match(/(\d+(?:\.\d+)?)/);
    if (!match) {
        return {
            texto: "‚ö†Ô∏è No se pudo evaluar el contenido de az√∫car",
            clase: "moderada"
        };
    }
    
    const gramos = parseFloat(match[1]);
    
    if (gramos <= 10) {
        return {
            texto: "‚úÖ BUENA OPCI√ìN: Bajo contenido de az√∫car",
            clase: "buena"
        };
    } else if (gramos <= 25) {
        return {
            texto: "‚ö†Ô∏è CONSUMO MODERADO: Contenido medio de az√∫car",
            clase: "moderada"
        };
    } else {
        return {
            texto: "‚ùå ALTO EN AZ√öCAR: Consumir ocasionalmente",
            clase: "alta"
        };
    }
}

// Funci√≥n espec√≠fica para recomendaciones en ni√±os
function darRecomendacionNinos(azucarTexto) {
    const match = azucarTexto.match(/(\d+(?:\.\d+)?)/);
    if (!match) {
        return {
            texto: "‚ö†Ô∏è No se pudo evaluar el contenido de az√∫car",
            clase: "moderada"
        };
    }
    
    const gramos = parseFloat(match[1]);
    const cucharaditas = gramos / 5;
    
    // L√≠mite recomendado para ni√±os: 15g (3 cucharaditas) al d√≠a
    if (gramos <= 6) {
        return {
            texto: `‚úÖ EXCELENTE PARA NI√ëOS: Solo ${cucharaditas.toFixed(1)} cucharadita(s)`,
            clase: "buena",
            porcentajeLimite: ((gramos / 15) * 100).toFixed(0)
        };
    } else if (gramos <= 15) {
        return {
            texto: `‚ö†Ô∏è ACEPTABLE PARA NI√ëOS: ${cucharaditas.toFixed(1)} cucharadita(s) - cerca del l√≠mite diario`,
            clase: "moderada",
            porcentajeLimite: ((gramos / 15) * 100).toFixed(0)
        };
    } else {
        return {
            texto: `‚ùå EXCEDE L√çMITE INFANTIL: ${cucharaditas.toFixed(1)} cucharadita(s) - supera la recomendaci√≥n diaria`,
            clase: "alta",
            porcentajeLimite: ((gramos / 15) * 100).toFixed(0)
        };
    }
}

        // Funci√≥n para mostrar los resultados
        function mostrarResultado(jugo) {
            document.getElementById('nombre').textContent = jugo.nombre;
            document.getElementById('marca').textContent = jugo.marca || '';
            document.getElementById('azucar').textContent = jugo.azucar;
            document.getElementById('calorias').textContent = jugo.calorias;
            document.getElementById('volumen').textContent = jugo.volumen || 'N/A';
            document.getElementById('tipo').textContent = jugo.tipo || 'Jugo';
            document.getElementById('ingredientes').textContent = jugo.ingredientes || 'No especificados';

            // Calcular cucharadas
            const cucharadas = calcularCucharadas(jugo.azucar);
            document.getElementById('cucharadas').textContent = `${cucharadas} cucharadas`;

            // Mostrar recomendaci√≥n
            const recomendacion = darRecomendacion(jugo.azucar);
            const recomendacionEl = document.getElementById('recomendacion');
            recomendacionEl.textContent = recomendacion.texto;
            recomendacionEl.className = `recomendacion ${recomendacion.clase}`;

            // Mostrar secci√≥n de resultados y ocultar b√∫squeda
            document.getElementById('searchSection').style.display = 'none';
            document.getElementById('resultadoContainer').style.display = 'block';
        }

        // Funci√≥n para buscar jugo por c√≥digo
          // Funci√≥n para buscar jugo por c√≥digo - VERSI√ìN ARREGLADA
async function buscarJugo() {
    const codigo = document.getElementById("codigo").value.trim();
    if (!codigo) {
        alert("Por favor, ingresa un c√≥digo.");
        return;
    }

    // Mostrar loading
    document.getElementById('nombre').textContent = 'Buscando producto...';
    document.getElementById('searchSection').style.display = 'none';
    document.getElementById('resultadoContainer').style.display = 'block';

    try {
        const res = await fetch(`https://world.openfoodfacts.org/api/v0/product/${codigo}.json`);

        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }

        const data = await res.json();

        if (data.status === 1 && data.product) {
            const producto = data.product;
            
            // Adaptar los datos de OpenFoodFacts al formato esperado
            const jugo = {
                nombre: producto.product_name || 'Producto sin nombre',
                marca: producto.brands || '',
                azucar: producto.nutriments?.sugars_100g ? `${producto.nutriments.sugars_100g}g` : 'No disponible',
                calorias: producto.nutriments?.['energy-kcal_100g'] ? `${producto.nutriments['energy-kcal_100g']} kcal` : 'No disponible',
                volumen: '100g', // OpenFoodFacts da valores por 100g
                tipo: producto.categories_tags?.includes('en:beverages') ? 'Bebida' : 'Producto',
                ingredientes: producto.ingredients_text || 'No especificados'
            };
            
            mostrarResultado(jugo);
        } else {
            // Producto no encontrado
            document.getElementById('nombre').textContent = 'Producto no encontrado';
            document.getElementById('marca').textContent = `C√≥digo: ${codigo}`;
            document.getElementById('azucar').textContent = '-';
            document.getElementById('calorias').textContent = '-';
            document.getElementById('volumen').textContent = '-';
            document.getElementById('tipo').textContent = '-';
            document.getElementById('ingredientes').textContent = '-';
            document.getElementById('cucharadas').textContent = '- cucharadas';
            
            const recomendacionEl = document.getElementById('recomendacion');
            recomendacionEl.innerHTML = `
                <div class="error">
                    ‚ùå No se encontr√≥ ning√∫n producto con el c√≥digo "${codigo}".<br>
                    Verifica que el c√≥digo est√© correcto.
                </div>
            `;
            recomendacionEl.className = 'recomendacion';
        }
    } catch (error) {
        console.error("Error al buscar el producto:", error);
        document.getElementById('nombre').textContent = 'Error al cargar datos';
        document.getElementById('marca').textContent = '';
        document.getElementById('azucar').textContent = '-';
        document.getElementById('calorias').textContent = '-';
        document.getElementById('volumen').textContent = '-';
        document.getElementById('tipo').textContent = '-';
        document.getElementById('ingredientes').textContent = '-';
        document.getElementById('cucharadas').textContent = '- cucharadas';
        
        const recomendacionEl = document.getElementById('recomendacion');
        recomendacionEl.innerHTML = `
            <div class="error">
                ‚ùå Error al cargar los datos.<br>
                Verifica tu conexi√≥n o intenta nuevamente m√°s tarde.<br>
                Error: ${error.message}
            </div>
        `;
        recomendacionEl.className = 'recomendacion';
    }
}  
// Funci√≥n para escanear otro producto - VERSI√ìN ARREGLADA
function escanearOtro() {
    // Limpiar el input
    document.getElementById('codigo').value = '';
    
    // Limpiar todos los campos de resultado
    document.getElementById('nombre').textContent = 'Cargando...';
    document.getElementById('marca').textContent = '';
    document.getElementById('azucar').textContent = '-';
    document.getElementById('calorias').textContent = '-';
    document.getElementById('volumen').textContent = '-';
    document.getElementById('tipo').textContent = '-';
    document.getElementById('ingredientes').textContent = '-';
    document.getElementById('cucharadas').textContent = '- cucharadas';
    
    // Limpiar recomendaci√≥n
    const recomendacionEl = document.getElementById('recomendacion');
    recomendacionEl.textContent = 'Evaluando producto...';
    recomendacionEl.className = 'recomendacion';
    
    // Mostrar secci√≥n de b√∫squeda y ocultar resultados
    document.getElementById('searchSection').style.display = 'block';
    document.getElementById('resultadoContainer').style.display = 'none';
    
    // Enfocar el input para facilitar la siguiente b√∫squeda
    document.getElementById('codigo').focus();
}
    </script>
</body>
</html>